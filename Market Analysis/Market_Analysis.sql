---Market Analysis 

-- Create Sale table with customer data 
Drop table if exists Sales
Create table Sales 
(
CustomerID int,
ProductID nvarchar(255),
PurchaseDate datetime,
Quantity int,
Revenue Decimal (10,2)
)

-- Insert data into Sales table 
Insert into Sales values
(1, 'A', '2024-01-01', 5, 500),
(2, 'B', '2024-01-02', 3, 50),
(3, 'A', '2024-01-03', 2, 30),
(4, 'C', '2024-01-03', 1, 20),
(5, 'B', '2024-01-04', 4, 80),
(6, 'C', '2024-01-05', 3, 60),
(7, 'A', '2024-01-06', 2, 30),
(8, 'B', '2024-01-07', 1, 20),
(9, 'A', '2024-01-08', 4, 57),
(10, 'C', '2024-01-09', 2, 40),
(11, 'A', '2024-01-10', 3, 50),
(12, 'B', '2024-01-11', 2, 30),
(13, 'C', '2024-01-12', 5, 600),
(14, 'A', '2024-01-13', 1, 20),
(15, 'B', '2024-01-14', 4, 25),
(16, 'C', '2024-01-15', 2, 40),
(17, 'A', '2024-01-16', 3, 60),
(18, 'B', '2024-01-17', 1, 20),
(19, 'A', '2024-01-18', 4, 80),
(20, 'C', '2024-01-19', 3, 60),
(21, 'A', '2024-01-20', 2, 30),
(22, 'B', '2024-01-21', 5, 200),
(23, 'C', '2024-01-22', 3, 60),
(24, 'A', '2024-01-23', 1, 20),
(25, 'B', '2024-01-24', 4, 80),
(26, 'C', '2024-01-25', 2, 40),
(27, 'A', '2024-01-26', 3, 60),
(28, 'B', '2024-01-27', 1, 20),
(29, 'A', '2024-01-28', 4, 80),
(30, 'C', '2024-01-29', 3, 60),
(31, 'A', '2024-01-30', 2, 30),
(32, 'B', '2024-01-31', 5, 750),
(33, 'C', '2024-02-01', 3, 60),
(34, 'A', '2024-02-02', 1, 20),
(35, 'B', '2024-02-03', 4, 80),
(36, 'C', '2024-02-04', 2, 40),
(37, 'A', '2024-02-05', 3, 60),
(38, 'B', '2024-02-06', 1, 20),
(39, 'A', '2024-02-07', 4, 80),
(40, 'C', '2024-02-08', 3, 60),
(41, 'A', '2024-02-09', 2, 30),
(42, 'B', '2024-02-10', 5, 250),
(43, 'C', '2024-02-11', 3, 60),
(44, 'A', '2024-02-12', 1, 20),
(45, 'B', '2024-02-13', 4, 80),
(46, 'C', '2024-02-14', 2, 40),
(47, 'A', '2024-02-15', 3, 60),
(48, 'B', '2024-02-16', 1, 20),
(49, 'A', '2024-02-17', 4, 80),
(50, 'C', '2024-02-18', 3, 60),
(51, 'A', '2024-02-19', 2, 30),
(52, 'B', '2024-02-20', 5, 75),
(53, 'C', '2024-02-21', 3, 60),
(54, 'A', '2024-02-22', 1, 20),
(55, 'B', '2024-02-23', 4, 80),
(56, 'C', '2024-02-24', 2, 40),
(57, 'A', '2024-02-25', 3, 60),
(58, 'B', '2024-02-26', 1, 20),
(59, 'A', '2024-02-27', 4, 80),
(60, 'C', '2024-02-28', 3, 60),
(61, 'A', '2024-02-29', 2, 30),
(62, 'B', '2024-03-01', 5, 55),
(63, 'C', '2024-03-02', 3, 60),
(64, 'A', '2024-03-03', 1, 20),
(65, 'B', '2024-03-04', 4, 80),
(66, 'C', '2024-03-05', 2, 40),
(67, 'A', '2024-03-06', 3, 60),
(68, 'B', '2024-03-07', 1, 20),
(69, 'A', '2024-03-08', 4, 80),
(70, 'C', '2024-03-09', 3, 60),
(71, 'A', '2024-03-10', 2, 30),
(72, 'B', '2024-03-11', 5, 35),
(73, 'C', '2024-03-12', 3, 60),
(74, 'A', '2024-03-13', 1, 20),
(75, 'B', '2024-03-14', 4, 80),
(76, 'C', '2024-03-15', 2, 40),
(77, 'A', '2024-03-16', 3, 60),
(78, 'B', '2024-03-17', 1, 20),
(79, 'A', '2024-03-18', 4, 80),
(80, 'C', '2024-03-19', 3, 60),
(81, 'A', '2024-03-20', 2, 30),
(82, 'B', '2024-03-21', 5, 100),
(83, 'C', '2024-03-22', 3, 60),
(84, 'A', '2024-03-23', 1, 20),
(85, 'B', '2024-03-24', 4, 80),
(86, 'C', '2024-03-25', 2, 40),
(87, 'A', '2024-03-26', 3, 60),
(88, 'B', '2024-03-27', 1, 20),
(89, 'A', '2024-03-28', 4, 80),
(90, 'C', '2024-03-29', 3, 60),
(91, 'A', '2024-03-30', 2, 30),
(92, 'B', '2024-03-31', 5, 700),
(93, 'C', '2024-04-01', 3, 60),
(94, 'A', '2024-04-02', 1, 20),
(95, 'B', '2024-04-03', 4, 80),
(96, 'C', '2024-04-04', 2, 40),
(97, 'A', '2024-04-05', 3, 60),
(98, 'B', '2024-04-06', 1, 20),
(99, 'A', '2024-04-07', 4, 80),
(100, 'C', '2024-04-08', 3, 60)


-- Display all records
Select * from Sales

-- Total Revenue
Select sum(Revenue) as Total_Revenue
from Sales

-- Total sales by Product
Select ProductID, sum(Quantity) as Total_Sales , sum(Revenue) as Total_Revenue
from Sales
group by ProductID

-- Top customers by Revenue
Select top 5 CustomerID, sum(Revenue) as Total_Revenue
from Sales
group by CustomerID
order by Total_Revenue Desc
